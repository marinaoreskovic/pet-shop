{{> header}}
<h1>Lista de Productos en Tiempo Real</h1>
<ul id="productsList"></ul>
<h2>Añadir Producto</h2>
<form id="addProductForm">
  <input type="text" name="title" placeholder="Título" required>
  <input type="number" name="price" placeholder="Precio" required>
  <button type="submit">Añadir</button>
</form>
<h2>Eliminar Producto</h2>
<form id="deleteProductForm">
  <input type="text" name="productId" placeholder="ID del Producto" required>
  <button type="submit">Eliminar</button>
</form>
<script src="/socket.io/socket.io.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', () => {
    const socket = io();

    socket.on('updateProducts', (products) => {
      const productsList = document.getElementById('productsList');
      productsList.innerHTML = '';
      products.forEach(product => {
        const li = document.createElement('li');
        li.textContent = `${product.title} - ${product.price}`;
        productsList.appendChild(li);
      });
    });

    document.getElementById('addProductForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const title = e.target.elements.title.value;
      const price = e.target.elements.price.value;
      socket.emit('addProduct', { title, price });
      e.target.reset();
    });

    document.getElementById('deleteProductForm').addEventListener('submit', (e) => {
      e.preventDefault();
      const productId = e.target.elements.productId.value;
      socket.emit('deleteProduct', productId);
      e.target.reset();
    });
  });
</script>
{{> footer}}
